{% extends 'base.html' %}
{% load static %}

{% block title %}Contacto | Crecer MÃ©xico{% endblock %}

{% block extra_head %}
<link href="{% static 'css/contact.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
{% if messages %}
    <div class="messages">
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    </div>
{% endif %}
<section class="contact-section">
    <div class="container">

        <div class="contact-header">
            <h1>{{ contact_info.Titulo }}</h1>
            <p>{{ contact_info.Subtitulo }}</p>
        </div>

        <div class="contact-decorative-wrapper">
            <div class="decor-box decor-box-1"></div>
            <div class="decor-box decor-box-2"></div>

            <div class="contact-unified-container">
                <!-- Formulario de Contacto -->
                <div class="contact-form-container">
                    <h2>EnvÃ­anos un Mensaje</h2>
                        <form id="contactForm" method="POST" action="">
                            {% csrf_token %}

                            <div class="form-group required">
                                <label for="nombre">Nombre Completo</label>
                                {{ form.name }}
                            </div>

                            <div class="form-group required">
                                <label for="correo">Correo ElectrÃ³nico</label>
                                {{ form.email }}
                            </div>

                            <div class="form-group required">
                                <label for="telefono">TelÃ©fono</label>
                                {{ form.phone }}
                            </div>

                            <div class="form-group">
                                <label for="asunto">Asunto</label>
                                {{ form.subject }}
                            </div>

                            <div class="form-group required">
                                <label for="mensaje">Mensaje</label>
                                {{ form.message }}
                            </div>

                            <button type="submit" class="submit-btn" id="submitBtn">
                                <span id="submitText">Enviar Mensaje</span>
                                <span id="submitLoader" style="display: none;">
                                    <i class="fas fa-spinner fa-spin"></i> Enviando...
                                </span>
                            </button>
                        </form>
                </div>
                <!-- Mapa y InformaciÃ³n de Contacto -->
                <div class="map-container">
                    <div class="map-header">
                        <h2>{{ contact_info.ubicacion_titulo }}</h2>
                        <p>{{ contact_info.ubicacion_subtitulo }}</p>
                    </div>

                    <div class="map-wrapper">
                        <iframe 
                            src="{{ contact_info.link_ubicacion }}"
                            loading="lazy" 
                            referrerpolicy="no-referrer-when-downgrade"
                            title="UbicaciÃ³n de Crecer MÃ©xico">
                        </iframe>
                    </div>

                    <div class="contact-info">
                        <div class="contact-info-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>{{ contact_info.direccion|linebreaksbr }}</span><br>
                            <i class="fas fa-phone"></i>
                            <span>{{ contact_info.telefono }}</span><br>
                            <i class="fas fa-envelope"></i>
                            <span>{{ contact_info.correo }}</span><br>
                            <i class="fas fa-clock"></i>
                            <span>{{ contact_info.horario|linebreaksbr }}</span>
                        </div>

                        <div class="contact-info-item">
                            <ul class="contact-info-list">
                                <li><strong>InformaciÃ³n para ingresar a clases:</strong></li>
                                <li>Promotora: {{ contact_info.promotora }} - {{ contact_info.tel_promotora }}</li>
                                <li>Promotor: {{ contact_info.promotor }} - {{ contact_info.tel_promotor }}</li>

                                <li><strong>Informes Ã¡rea educativa:</strong></li>
                                <li>Gerente Educativa: {{ contact_info.gerente_educativa }}</li>
                                <li>ðŸ“§ {{ contact_info.correo_gerente_educativa }}</li>

                                <li><strong>Becas y apoyo institucional:</strong></li>
                                <li>Gerente de Operaciones: {{ contact_info.gerente_operaciones }}</li>
                                <li>ðŸ“§ {{ contact_info.correo_gerente_operaciones }}</li>

                                <li><strong>Servicio social y bolsa de trabajo:</strong></li>
                                <li>ðŸ“§ {{ contact_info.correo_servicio_social }}</li>

                                <li><strong>Alianzas estratÃ©gicas:</strong></li>
                                <li>ðŸ“§ {{ contact_info.correo_alianzas }}</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('contactForm');
    const submitBtn = document.getElementById('submitBtn');
    const submitText = document.getElementById('submitText');
    const submitLoader = document.getElementById('submitLoader');
    
    // Form validation
    const inputs = form.querySelectorAll('input[required], textarea[required]');
    
    function validateForm() {
        let isValid = true;
        inputs.forEach(input => {
            if (!input.value.trim()) {
                isValid = false;
                input.style.borderColor = '#e53e3e';
            } else {
                input.style.borderColor = '#69c624';
            }
        });
        
        // Email validation
        const emailInput = document.getElementById('correo');
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(emailInput.value)) {
            isValid = false;
            emailInput.style.borderColor = '#e53e3e';
        }
        
        // Phone validation (basic)
        const phoneInput = document.getElementById('telefono');
        const phoneRegex = /^[\+]?[\d\s\-\(\)]{10,}$/;
        if (!phoneRegex.test(phoneInput.value)) {
            isValid = false;
            phoneInput.style.borderColor = '#e53e3e';
        }
        
        return isValid;
    }
    
    // Real-time validation
    inputs.forEach(input => {
        input.addEventListener('blur', validateForm);
        input.addEventListener('input', function() {
            if (this.value.trim()) {
                this.style.borderColor = '#69c624';
            }
        });
    });
    

    form.addEventListener('submit', function(e) {
        
        if (!validateForm()) {
            alert('Por favor, completa todos los campos requeridos correctamente.');
            return;
        }
        submitBtn.disabled = true;
        submitText.style.display = 'none';
        submitLoader.style.display = 'inline';

        setTimeout(() => {
            submitBtn.disabled = false;
            submitText.style.display = 'inline';
            submitLoader.style.display = 'none';

            inputs.forEach(input => {
                input.style.borderColor = '#e2e8f0';
            });

            form.reset();
            alert('Â¡Mensaje enviado exitosamente!');
        }, 2000);
    });
    
    const phoneInput = document.getElementById('telefono');
    phoneInput.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length >= 10) {
            value = value.replace(/(\d{2})(\d{3})(\d{3})(\d{4})/, '+$1 $2 $3 $4');
        } else if (value.length >= 7) {
            value = value.replace(/(\d{3})(\d{3})(\d{1,4})/, '$1 $2 $3');
        } else if (value.length >= 4) {
            value = value.replace(/(\d{3})(\d{1,3})/, '$1 $2');
        }
        e.target.value = value;
    });
;
</script>
{% endblock %}